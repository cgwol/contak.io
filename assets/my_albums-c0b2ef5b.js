import{s as m,u as p,b as h,r as d,j as b,F as y,c as e,N as A}from"./index-88cc3bb7.js";import{E as j}from"./index-88cc3bb7.js";import{f as _,A as v,c as g}from"./fetchSignedAlbumUrls-842ad04c.js";import"./tracks-6e7a3842.js";const E=async()=>{const{data:i,error:t}=await m.from("my_profile").select().maybeSingle();if(t)throw t;if(i.user_type!=="Creator")throw new Error("Access Denied: Only Creators can access this page");const{data:s,error:o}=await m.from("my_albums").select().limit(30);if(o)throw o;const{albumCovers:a,trackFiles:c}=await _(s);for(const r of s)if(r.signedUrls=a.get(r.album_id),Array.isArray(r.album_tracks))for(const l of r.album_tracks)l.signedUrl=c.get(l.track_id);return{my_albums:s,my_profile:i}},N=function(){const{my_albums:t,my_profile:s}=p(),o=h(),a=d.useRef(null),[c,r]=d.useState(!1),l=()=>r(!0),u=()=>r(!1);return b(y,{children:[e(A,{}),e("div",{className:`absolute-fill flex-center bg-neutral-800 ${c?"":"hidden"}`,style:{zIndex:999,opacity:.8},children:b("form",{onSubmit:n=>{n.preventDefault();const f=a.current.value;g(f).then(()=>{u(),o.revalidate(),a.current.value=""})},children:[e("button",{onClick:u,style:{float:"right"},type:"button",children:"Cancel"}),e("h4",{children:"New Album"}),e("div",{children:e("input",{type:"text",placeholder:"album name...",ref:a,required:!0})}),e("button",{type:"submit",children:"Create"})]})}),e("h1",{children:"My Albums"}),e("button",{onClick:l,children:"Add Album"}),Array.isArray(t)&&e("div",{children:t.map(n=>e(v,{album:n},n.album_id))})]})};export{N as Component,j as ErrorBoundary,E as loader};
